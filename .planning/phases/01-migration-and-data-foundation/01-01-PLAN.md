---
phase: 01-migration-and-data-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  # Backend DELETE
  - fastapi-backend/app/models/note.py
  - fastapi-backend/app/schemas/note.py
  - fastapi-backend/app/routers/notes.py
  - fastapi-backend/tests/test_notes.py
  # Backend MODIFY
  - fastapi-backend/app/models/__init__.py
  - fastapi-backend/app/models/application.py
  - fastapi-backend/app/models/user.py
  - fastapi-backend/app/models/attachment.py
  - fastapi-backend/app/routers/__init__.py
  - fastapi-backend/app/main.py
  - fastapi-backend/alembic/env.py
  # Frontend DELETE
  - electron-app/src/renderer/contexts/notes-context.tsx
  - electron-app/src/renderer/__tests__/notes-context.test.tsx
  - electron-app/src/renderer/stores/notes-store.ts
  - electron-app/src/renderer/pages/notes/index.tsx
  - electron-app/src/renderer/components/notes/note-editor.tsx
  - electron-app/src/renderer/components/notes/notes-sidebar.tsx
  - electron-app/src/renderer/components/notes/notes-tab-bar.tsx
  # Frontend MODIFY
  - electron-app/src/renderer/App.tsx
  - electron-app/src/renderer/contexts/index.ts
  - electron-app/src/renderer/stores/index.ts
  - electron-app/src/renderer/pages/dashboard.tsx
  - electron-app/src/renderer/components/layout/sidebar.tsx
autonomous: true

must_haves:
  truths:
    - "No file in the codebase imports from note.py, notes.py, notes-context, notes-store, or any notes/ component directory"
    - "Backend starts without errors (uvicorn app.main:app loads cleanly)"
    - "Frontend compiles without errors (npm run typecheck passes)"
    - "No 'notes' navigation item appears in the sidebar"
    - "Dashboard page no longer has a 'notes' case in its navigation switch"
  artifacts:
    - path: "fastapi-backend/app/main.py"
      provides: "App without notes_router"
      contains: "No notes_router reference"
    - path: "electron-app/src/renderer/App.tsx"
      provides: "App without NotesProvider"
      contains: "No NotesProvider import or usage"
    - path: "electron-app/src/renderer/pages/dashboard.tsx"
      provides: "Dashboard without NotesPage"
      contains: "No NotesPage import or notes case"
  key_links:
    - from: "fastapi-backend/app/models/application.py"
      to: "Note model"
      via: "notes relationship removed"
      pattern: "No relationship.*notes"
    - from: "fastapi-backend/app/models/attachment.py"
      to: "Note model"
      via: "note_id FK removed"
      pattern: "No note_id column"
---

<objective>
Remove the old notes system entirely from both backend and frontend. Delete all notes-related models, schemas, routers, contexts, components, pages, and tests. Clean up all references in files that imported or depended on notes code.

Purpose: Create a clean slate for the new knowledge base document system. The old notes system uses outdated patterns (offset pagination, single content column, application-only scope) that are incompatible with the new architecture.

Output: A codebase with zero references to the old notes system. Backend starts cleanly, frontend compiles without errors.
</objective>

<execution_context>
@C:\Users\samng\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\samng\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-migration-and-data-foundation/01-RESEARCH.md

Key reference files (read these to understand what to remove):
@fastapi-backend/app/models/note.py
@fastapi-backend/app/routers/notes.py
@fastapi-backend/app/models/__init__.py
@fastapi-backend/app/models/application.py
@fastapi-backend/app/models/user.py
@fastapi-backend/app/models/attachment.py
@fastapi-backend/app/routers/__init__.py
@fastapi-backend/app/main.py
@fastapi-backend/alembic/env.py
@electron-app/src/renderer/App.tsx
@electron-app/src/renderer/contexts/index.ts
@electron-app/src/renderer/stores/index.ts
@electron-app/src/renderer/pages/dashboard.tsx
@electron-app/src/renderer/components/layout/sidebar.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove old notes backend code and clean up references</name>
  <files>
    fastapi-backend/app/models/note.py (DELETE)
    fastapi-backend/app/schemas/note.py (DELETE)
    fastapi-backend/app/routers/notes.py (DELETE)
    fastapi-backend/tests/test_notes.py (DELETE)
    fastapi-backend/app/models/__init__.py (MODIFY)
    fastapi-backend/app/models/application.py (MODIFY)
    fastapi-backend/app/models/user.py (MODIFY)
    fastapi-backend/app/models/attachment.py (MODIFY)
    fastapi-backend/app/routers/__init__.py (MODIFY)
    fastapi-backend/app/main.py (MODIFY)
    fastapi-backend/alembic/env.py (MODIFY)
    fastapi-backend/app/schemas/__init__.py (MODIFY if it exports note schemas)
  </files>
  <action>
    1. DELETE these files entirely:
       - `fastapi-backend/app/models/note.py`
       - `fastapi-backend/app/schemas/note.py`
       - `fastapi-backend/app/routers/notes.py`
       - `fastapi-backend/tests/test_notes.py`

    2. MODIFY `fastapi-backend/app/models/__init__.py`:
       - Remove the `Note` import and any `Note` entry in `__all__`

    3. MODIFY `fastapi-backend/app/models/application.py`:
       - Remove the `notes` relationship (back_populates="application" or similar, approx lines 92-97)
       - Remove the import of Note if present

    4. MODIFY `fastapi-backend/app/models/user.py`:
       - Remove the `created_notes` relationship (approx lines 102-106)
       - Remove the import of Note if present

    5. MODIFY `fastapi-backend/app/models/attachment.py`:
       - Remove the `note_id` Column (FK to Notes table, approx lines 96-101)
       - Remove the `note` relationship (approx lines 128-133)
       - Keep all other attachment columns and relationships intact

    6. MODIFY `fastapi-backend/app/routers/__init__.py`:
       - Remove `notes_router` import and any `notes_router` entry in `__all__`

    7. MODIFY `fastapi-backend/app/main.py`:
       - Remove `notes_router` import
       - Remove `app.include_router(notes_router, ...)` line

    8. MODIFY `fastapi-backend/alembic/env.py`:
       - Remove `Note` import if present (Alembic needs to see models for autogenerate, but not deleted ones)

    9. MODIFY `fastapi-backend/app/schemas/__init__.py`:
       - Remove any note schema imports/exports (NoteCreate, NoteUpdate, NoteResponse, etc.)

    10. Run a grep across `fastapi-backend/` for any remaining references to "note" (case-insensitive) in Python files and clean up any missed references. Ignore comments if they reference notes in a general documentation sense.

    IMPORTANT: Do NOT create or run any Alembic migrations in this task. The migration (dropping old tables + creating new tables) will be done atomically in Plan 01-03.
  </action>
  <verify>
    - `cd fastapi-backend && python -c "from app.models import *; print('Models OK')"` succeeds
    - `grep -r "from.*models.*import.*Note" fastapi-backend/app/ --include="*.py"` returns no results
    - `grep -r "notes_router" fastapi-backend/app/ --include="*.py"` returns no results
    - `grep -r "note_id" fastapi-backend/app/models/attachment.py` returns no results
  </verify>
  <done>
    All backend note-related files are deleted. All references to Note model, note schemas, notes router, and note_id FK are removed from application.py, user.py, attachment.py, main.py, routers/__init__.py, models/__init__.py, schemas/__init__.py, and alembic/env.py. Backend Python imports resolve without errors.
  </done>
</task>

<task type="auto">
  <name>Task 2: Remove old notes frontend code and clean up references</name>
  <files>
    electron-app/src/renderer/contexts/notes-context.tsx (DELETE)
    electron-app/src/renderer/__tests__/notes-context.test.tsx (DELETE)
    electron-app/src/renderer/stores/notes-store.ts (DELETE)
    electron-app/src/renderer/pages/notes/index.tsx (DELETE)
    electron-app/src/renderer/components/notes/note-editor.tsx (DELETE)
    electron-app/src/renderer/components/notes/notes-sidebar.tsx (DELETE)
    electron-app/src/renderer/components/notes/notes-tab-bar.tsx (DELETE)
    electron-app/src/renderer/App.tsx (MODIFY)
    electron-app/src/renderer/contexts/index.ts (MODIFY)
    electron-app/src/renderer/stores/index.ts (MODIFY)
    electron-app/src/renderer/pages/dashboard.tsx (MODIFY)
    electron-app/src/renderer/components/layout/sidebar.tsx (MODIFY)
  </files>
  <action>
    1. DELETE these files/directories entirely:
       - `electron-app/src/renderer/contexts/notes-context.tsx` (700+ lines)
       - `electron-app/src/renderer/__tests__/notes-context.test.tsx`
       - `electron-app/src/renderer/stores/notes-store.ts`
       - `electron-app/src/renderer/pages/notes/index.tsx` (900+ lines)
       - `electron-app/src/renderer/components/notes/note-editor.tsx`
       - `electron-app/src/renderer/components/notes/notes-sidebar.tsx`
       - `electron-app/src/renderer/components/notes/notes-tab-bar.tsx`
       - Delete the entire `electron-app/src/renderer/pages/notes/` directory if empty after deletion
       - Delete the entire `electron-app/src/renderer/components/notes/` directory if empty after deletion

    2. MODIFY `electron-app/src/renderer/App.tsx`:
       - Remove `<NotesProvider>` wrapper and its closing tag from the component tree
       - Remove the NotesProvider import (from `@/contexts` or `@/stores`)
       - Keep all other providers intact (AuthProvider, QueryClientProvider, ThemeProvider, etc.)

    3. MODIFY `electron-app/src/renderer/contexts/index.ts`:
       - Remove ALL notes-related exports (NotesProvider, useNotesStore, selectNotes, selectNoteTree, selectSelectedNote, selectOpenTabs, selectActiveTabId, selectActiveTab, selectNotesIsLoading, selectNotesError, Note, NoteTree, NoteCreate, NoteUpdate, NoteTab, NoteError)
       - Keep auth and notification-ui exports intact

    4. MODIFY `electron-app/src/renderer/stores/index.ts`:
       - Remove the entire notes-context re-export block (NotesProvider, useNotesStore, selectNotes, etc.)
       - Keep auth and notification-ui re-exports intact (these will be cleaned up in Plan 01-02)

    5. MODIFY `electron-app/src/renderer/pages/dashboard.tsx`:
       - Remove the `NotesPage` import (lazy or direct)
       - Remove the `'notes'` case from the navigation switch/conditional rendering
       - Keep all other page cases intact

    6. MODIFY `electron-app/src/renderer/components/layout/sidebar.tsx`:
       - Remove the 'notes' navigation item from the sidebar menu
       - Keep all other navigation items intact

    7. Run a grep across `electron-app/src/` for any remaining references to "notes-context", "notes-store", "NotesProvider", "useNotesStore", "NotesPage", or components/notes/ and clean up.
  </action>
  <verify>
    - `cd electron-app && npm run typecheck` passes with zero errors
    - `grep -r "notes-context\|notes-store\|NotesProvider\|useNotesStore\|NotesPage" electron-app/src/renderer/ --include="*.ts" --include="*.tsx"` returns no results (except possibly this plan file)
    - `ls electron-app/src/renderer/pages/notes/` fails (directory should not exist)
    - `ls electron-app/src/renderer/components/notes/` fails (directory should not exist)
  </verify>
  <done>
    All frontend notes-related files are deleted: contexts/notes-context.tsx, tests, stores/notes-store.ts, pages/notes/, components/notes/. All references removed from App.tsx (NotesProvider), contexts/index.ts, stores/index.ts, dashboard.tsx (NotesPage + nav case), and sidebar.tsx (notes nav item). Frontend compiles cleanly with `npm run typecheck`.
  </done>
</task>

</tasks>

<verification>
1. Backend starts: `cd fastapi-backend && python -c "from app.main import app; print('App created OK')"`
2. Frontend compiles: `cd electron-app && npm run typecheck`
3. No notes references: `grep -r "note" fastapi-backend/app/ --include="*.py" -l` should only return files with legitimate non-notes uses (e.g., "notification")
4. No notes references: `grep -ri "NotesProvider\|useNotesStore\|notes-context\|notes-store\|NotesPage\|note-editor\|notes-sidebar\|notes-tab-bar" electron-app/src/renderer/ --include="*.ts" --include="*.tsx"` returns empty
</verification>

<success_criteria>
- Zero files remain that define or import old notes system code
- Backend Python module imports resolve without ImportError
- Frontend TypeScript compiles without type errors
- Sidebar has no "Notes" navigation entry
- Dashboard page has no "notes" rendering case
</success_criteria>

<output>
After completion, create `.planning/phases/01-migration-and-data-foundation/01-01-SUMMARY.md`
</output>
