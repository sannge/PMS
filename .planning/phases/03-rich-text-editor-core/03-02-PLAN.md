---
phase: 03-rich-text-editor-core
plan: 02
type: execute
wave: 2
depends_on: ["03-01"]
files_modified:
  - electron-app/src/renderer/components/knowledge/editor-toolbar.tsx
autonomous: true

must_haves:
  truths:
    - "User can select Paragraph or any heading level H1-H6 from a dropdown in the toolbar"
    - "User can toggle bullet lists, numbered lists, and interactive checklists from toolbar buttons"
    - "Checklist items have toggleable checkboxes that visually check/uncheck"
    - "User can insert a code block from the toolbar"
    - "Code blocks display syntax highlighting with colored tokens"
    - "User can increase and decrease indentation from toolbar buttons"
  artifacts:
    - path: "electron-app/src/renderer/components/knowledge/editor-toolbar.tsx"
      provides: "Heading dropdown, list buttons, checklist button, code block button, indent buttons added to toolbar"
  key_links:
    - from: "editor-toolbar.tsx heading dropdown"
      to: "editor.chain().focus().toggleHeading({ level }).run()"
      via: "onClick handler"
      pattern: "toggleHeading"
    - from: "editor-toolbar.tsx checklist button"
      to: "editor.chain().focus().toggleTaskList().run()"
      via: "onClick handler"
      pattern: "toggleTaskList"
    - from: "editor-toolbar.tsx code block button"
      to: "editor.chain().focus().toggleCodeBlock().run()"
      via: "onClick handler"
      pattern: "toggleCodeBlock"
---

<objective>
Add heading dropdown (Paragraph + H1-H6), list buttons (bullet, numbered, checklist), code block button, and indentation controls to the editor toolbar.

Purpose: Covers requirements EDIT-02 (headings), EDIT-03 (lists + indentation), EDIT-04 (interactive checklists), and EDIT-06 (code blocks with syntax highlighting). The extensions are already configured in plan 01's factory -- this plan only adds the toolbar UI.

Output: Toolbar has heading dropdown, list/checklist buttons, code block button, and indent/outdent buttons.
</objective>

<execution_context>
@C:\Users\samng\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\samng\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/03-rich-text-editor-core/03-RESEARCH.md
@.planning/phases/03-rich-text-editor-core/03-01-SUMMARY.md
@electron-app/src/renderer/components/knowledge/editor-toolbar.tsx
@electron-app/src/renderer/components/knowledge/editor-extensions.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add heading dropdown, list/checklist buttons, code block, and indent controls to toolbar</name>
  <files>electron-app/src/renderer/components/knowledge/editor-toolbar.tsx</files>
  <action>
Read the existing `editor-toolbar.tsx` from plan 01. Add three new toolbar groups AFTER the existing alignment group but BEFORE any future groups (the toolbar renders groups left to right).

**Group 1: Heading Dropdown** (between alignment group and lists group)

Use a Popover (not a native select) for the heading dropdown:
- Trigger button shows current block type label: "Paragraph", "Heading 1", ... "Heading 6"
- Use Heading icon (from lucide-react) + current label text + ChevronDown icon
- Trigger class: `flex items-center gap-1 px-2 py-1.5 rounded hover:bg-muted text-xs`
- Popover content: vertical list of buttons
  - "Paragraph" button: `editor.chain().focus().setParagraph().run()`, active when NOT heading
  - "Heading 1" through "Heading 6": `editor.chain().focus().toggleHeading({ level: N }).run()`, active when `editor.isActive('heading', { level: N })`
  - Each heading button shows text at relative size: H1 largest (text-xl font-bold), H2 (text-lg font-bold), H3 (text-base font-semibold), H4 (text-sm font-semibold), H5 (text-sm font-medium), H6 (text-xs font-medium)
  - Active item gets `bg-primary/10` highlight

Create a helper function `getCurrentHeadingLabel(editor: Editor): string` that returns "Paragraph" or "Heading N" based on current selection.

Import additional icons: `Heading` from lucide-react.

**Group 2: Lists, Checklist, and Indentation** (after heading dropdown)

Buttons in order:
- Bullet list: `List` icon, `editor.chain().focus().toggleBulletList().run()`, active when `editor.isActive('bulletList')`
- Numbered list: `ListOrdered` icon, `editor.chain().focus().toggleOrderedList().run()`, active when `editor.isActive('orderedList')`
- Checklist (task list): `ListTodo` icon (from lucide-react), `editor.chain().focus().toggleTaskList().run()`, active when `editor.isActive('taskList')`
- Decrease indent: `IndentDecrease` icon, handler: if `editor.can().liftListItem('listItem')` then `liftListItem('listItem')`, else if `editor.can().liftListItem('taskItem')` then `liftListItem('taskItem')`, else `(editor.chain().focus() as any).outdent().run()`
- Increase indent: `IndentIncrease` icon, handler: if `editor.can().sinkListItem('listItem')` then `sinkListItem('listItem')`, else if `editor.can().sinkListItem('taskItem')` then `sinkListItem('taskItem')`, else `(editor.chain().focus() as any).indent().run()`

Import additional icons: `List, ListOrdered, ListTodo, IndentIncrease, IndentDecrease`.

**Group 3: Code Block** (after lists group)

Single button:
- `Code2` icon (from lucide-react, or use `Braces`; if neither exists, use `FileCode`), title "Code Block"
- `editor.chain().focus().toggleCodeBlock().run()`
- Active when `editor.isActive('codeBlock')`

Import additional icon: one of `Code2`, `Braces`, or `FileCode` from lucide-react (check which exists).

All new groups should use the same `border-r pr-2` divider pattern as existing groups.
  </action>
  <verify>
Run `cd electron-app && npx tsc --noEmit` to confirm no TypeScript errors.
Run `cd electron-app && npm run lint` to confirm no lint warnings.
  </verify>
  <done>Toolbar shows heading dropdown (Paragraph + H1-H6), bullet list, numbered list, checklist, indent/outdent, and code block buttons. All buttons toggle their respective editor commands. Code blocks render with syntax highlighting via the CodeBlockLowlight extension configured in plan 01. Checklists render with toggleable checkboxes styled by plan 01's CSS.</done>
</task>

</tasks>

<verification>
1. `cd electron-app && npx tsc --noEmit` -- zero errors
2. `cd electron-app && npm run lint` -- zero warnings
3. Heading dropdown exists with Paragraph + 6 heading levels
4. List buttons (bullet, numbered, checklist) exist in toolbar
5. Code block button exists in toolbar
6. Indent/outdent buttons exist in toolbar
</verification>

<success_criteria>
- Heading dropdown shows current block type and allows switching between Paragraph and H1-H6
- Bullet list, numbered list, and checklist toggle from toolbar
- Checklist items have checkboxes (styled by CSS from plan 01)
- Code block can be inserted and shows syntax highlighting (extension from plan 01)
- Indent/outdent works for both lists and paragraphs
- Zero TypeScript errors, zero lint warnings
</success_criteria>

<output>
After completion, create `.planning/phases/03-rich-text-editor-core/03-02-SUMMARY.md`
</output>
