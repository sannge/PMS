---
phase: 03-rich-text-editor-core
plan: 03
type: execute
wave: 3
depends_on: ["03-02"]
files_modified:
  - electron-app/src/renderer/components/knowledge/editor-toolbar.tsx
autonomous: true

must_haves:
  truths:
    - "User can insert a table from the toolbar"
    - "Table has resizable columns via drag handles between column borders"
    - "User can add a row or column to an existing table via toolbar buttons"
    - "User can remove a row, column, or entire table via toolbar buttons"
    - "Table controls only appear in toolbar when cursor is inside a table"
  artifacts:
    - path: "electron-app/src/renderer/components/knowledge/editor-toolbar.tsx"
      provides: "Insert table button and conditional table controls (add/remove row/column, delete table)"
  key_links:
    - from: "editor-toolbar.tsx insert table button"
      to: "editor.chain().focus().insertTable()"
      via: "onClick handler"
      pattern: "insertTable"
    - from: "editor-toolbar.tsx table controls visibility"
      to: "editor.isActive('table')"
      via: "conditional render"
      pattern: "isActive.*table"
---

<objective>
Add table insertion button and contextual table controls (add/remove rows and columns, delete table) to the editor toolbar.

Purpose: Covers requirement EDIT-05 (tables with resizable columns, add/remove rows and columns). The Table extension with `resizable: true` was configured in plan 01. Column resize handles are styled by plan 01's CSS. This plan adds the toolbar UI for inserting and managing tables.

Output: Toolbar has "Insert Table" button and contextual table manipulation controls that appear when cursor is inside a table.
</objective>

<execution_context>
@C:\Users\samng\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\samng\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/03-rich-text-editor-core/03-RESEARCH.md
@.planning/phases/03-rich-text-editor-core/03-02-SUMMARY.md
@electron-app/src/renderer/components/knowledge/editor-toolbar.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add table insert button and contextual table controls to toolbar</name>
  <files>electron-app/src/renderer/components/knowledge/editor-toolbar.tsx</files>
  <action>
Read the existing `editor-toolbar.tsx`. Add table controls to the toolbar.

**Insert Table Button** (add to the "Insert" group area, after code block group):

A new group with:
- "Insert Table" button: `Table` icon (from lucide-react, import as `TableIcon` to avoid conflict with TipTap Table), title "Insert Table"
- Handler: `editor.chain().focus().insertTable({ rows: 3, cols: 3, withHeaderRow: true }).run()`
- Active state: `editor.isActive('table')`

Import: `Table as TableIcon` from lucide-react (if not already imported), `Plus`, `Trash2` from lucide-react.

**Conditional Table Controls** (only visible when `editor.isActive('table')`):

Wrap in `{editor.isActive('table') && (...)}`. Render as a separate group with `pl-2 border-l` divider (visually separates from main toolbar).

Buttons:
1. "Add Column After": `Plus` icon, `editor.chain().focus().addColumnAfter().run()`, title "Add Column"
2. "Add Row After": `Plus` icon rotated 90deg (`className="h-4 w-4 rotate-90"`), `editor.chain().focus().addRowAfter().run()`, title "Add Row"
3. "Delete Column": `Trash2` icon with `text-destructive` color, `editor.chain().focus().deleteColumn().run()`, title "Delete Column"
4. "Delete Row": `Trash2` icon rotated 90deg with `text-destructive`, `editor.chain().focus().deleteRow().run()`, title "Delete Row"
5. "Delete Table": `TableIcon` with `text-destructive`, `editor.chain().focus().deleteTable().run()`, title "Delete Table"

This matches the exact pattern from `RichTextEditor.tsx` lines 788-821.
  </action>
  <verify>
Run `cd electron-app && npx tsc --noEmit` to confirm no TypeScript errors.
Run `cd electron-app && npm run lint` to confirm no lint warnings.
  </verify>
  <done>Toolbar shows "Insert Table" button. When cursor is inside a table, contextual controls appear for adding/removing rows and columns and deleting the table. Table columns are resizable via drag handles (extension + CSS from plan 01).</done>
</task>

</tasks>

<verification>
1. `cd electron-app && npx tsc --noEmit` -- zero errors
2. `cd electron-app && npm run lint` -- zero warnings
3. "Insert Table" button visible in toolbar
4. Table controls conditionally render when cursor is in a table
</verification>

<success_criteria>
- Insert Table button creates a 3x3 table with header row
- Table controls (add/remove row/column, delete table) appear only when cursor is inside a table
- Column resize handles are visible and functional (from plan 01's extension config + CSS)
- Zero TypeScript errors, zero lint warnings
</success_criteria>

<output>
After completion, create `.planning/phases/03-rich-text-editor-core/03-03-SUMMARY.md`
</output>
